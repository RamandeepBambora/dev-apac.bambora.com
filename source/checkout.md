---
title: dev/bambora

language_tabs:
  - shell: cURL
  - HTML

toc_above:
- <a href='index.html'>Getting Started</a>
- <a href='checkout.html'>Checkout</a>

includes:

toc_below:
- <a href='apis.html'>APIs</a>
- <a href='backoffice.html'>Backoffice</a>
- <a href='testing.html'>Testing</a>

search: false
---
<script src='js/vendor/clipboard.min.js'></script>
<script src='js/copy.js'></script>

#Overview

Bambora have developed a flexible and innovative platform called Checkout for delivering payments online which is device agnostic, with responsive functionality over web, tablet and all other mobile devices

This guide will provide you with all information you need in order to get started.
First you should identify how you would to include the Checkout in your business.      

There are two options:

* Integrated
* Standalone

#Integrated

Checkout Integrated allow you to embed the payment page within your website through an iFrame. This enables your customer make the payment on your website and allow you to provide a seamless integration with Bambora through the purchase with transaction status returned back to your internal system.

Processing online transactions by Integrated requires the following sequence:

##1. Create a session

Firstly, the POST generated by your server is submitted to the Bambora server
URL: [https://demo.bambora.co.nz/access/index.aspx](https://demo.bambora.co.nz/access/index.aspx)

```shell
cURL "https://demo.bambora.co.nz/access/index.aspx"
-d 'UserName=[API Username]'
-d 'password=[API Password]'
-d 'CustRef=[reference]'
-d 'Amount=[amount value]'
-d 'SessionId=[SessionId]'
-d 'SessionKey=[SessionKey]'
-d 'dl=checkout_V1_IHPP_Purchase'
-d 'ServerURL=[ServerURL]'
-d 'UserURL=[UserURL]'
-d 'AccountNumber=[Account Number]'
```

There are two version of the integrated checkout page which can be configured through the DLs below:

**Integrated v1** - DL=checkout_v1_purchase), which allows you to pre-populate the **Amount** value before launching the page.

**Integrated v2** - DL=checkout_v2_purchase), which allows your customer to input the **Amount** and **Reference** details on the page.

**Session Response**

The response contains a secure session token (SST).

```HTML
<html>
  <body>
    <form>
      <input type="hidden" name="SessionStored" value="True" />
      <input type="hidden" name="SessionStoredError" value="" />
      <input type="hidden" name="SST" value="5838f953-c600-454c-9c47-2b3499eed21a" />
   </form>
  </body>
</html>
```

##2. Payment Page and Transaction Processing

Great, you’re onto the next part of the sequence.

Once the session is established, your backend application notifies your website which then POSTs (GET also supported) the Session ID and Secure Session Token to Bambora’s server URL - [https://demo.ippayments.com.au/access/index.aspx](https://demo.ippayments.com.au/access/index.aspx). You can perform this redirection in an iFrame or just redirect the entire site.

Once the payment is submitted you should expect two responses back from Bambora.

***1st response***

The Bambora server POSTs the response to your server using the ‘ServerURL’ as supplied by you in the session initiation. The following table lists the response values that Bambora will POST to your server. The response data should be stored in your database and made accessible to your website.

```HTML
<html>
  <body>
    <form>
      <input type="hidden" name="SessionId" value="WIZ201702241044133171a4c36a760e" />
      <input type="hidden" name="SST" value="d98eedec-6fe4-4ee4-84e3-9c90892389a5" />
      <input type="hidden" name="SessionKey" value="WIZKEY2bacb4ebda" />
      <input type="hidden" name="CustRef" value="your_custref" />
      <input type="hidden" name="CustNumber" value="your_custnumber" />
      <input type="hidden" name="Amount" value="1000" />
      <input type="hidden" name="Surcharge" value="" />
      <input type="hidden" name="AmountIncludingSurcharge" value="1000" />
      <input type="hidden" name="Result" value="1" />
      <input type="hidden" name="DeclinedCode" value="" />
      <input type="hidden" name="DeclinedMessage" value="" />
      <input type="hidden" name="Receipt" value="90892516" />
      <input type="hidden" name="TxDateTime" value="2017-02-24+13%3a10%3a15" />
      <input type="hidden" name="SettlementDate" value="2017-02-24" />
      <input type="hidden" name="MaskedCard" value="424242******4242" />
      <input type="hidden" name="CardHolderName" value="cardholder name" />
      <input type="hidden" name="ExpiryDate" value="08/19" />
      <input type="hidden" name="CardType" value="Visa" />
    </form>
  </body>
</html>
```

***2nd response***

Bambora redirect to the ‘UserURL’ as supplied in the Session Initiation request and POST’s the SessionID and SST. Your UserURL page can use these details to access the transaction results stored in your database from the first notification.

Once your UserURL page receives the transaction result, it can display the details to the customer.

And you’re done.

```HTML
<html>
  <body>
    <form>
      <input type="hidden" name="SessionStored" value="True" />
      <input type="hidden" name="SST" value="5838f953-c600-454c-9c47-2b3499eed21a" />
   </form>
  </body>
</html>
```

##Technical details

**Session Initiation Request - Body Schema**

Parameter |         | Description
--------- | ------- | -----------
Username | string(16) | API Username
Password | string(16) | API Password
Amount | Numeric | Amount entered in cent value e.g. $55.00 = 5500
SessionID | string(64) | Merchant’s unique session identifier. Maintain this session identifier throughout the life of the transaction.
SessionKey | string(512) | Generated by the merchant, can be any value e.g. random generated number, timestamp etc. The session key is to be included for security and authentication purposes. This Key should only be passed to Bambora’s server and should not be sent to your front end. Bambora will return the SessionKey to your ServerURL in the transaction response once the payment has been processed. If you do not receive a SessionKey or receive an invalid SessionKey, then this should be treated as a possible fraudulent transaction. Bambora needs to be notified of this event along with your internal teams for investigation.
ServerURL | string(512) | This value must be Base 64 encoded. The URL of your server that Bambora will POST the first notification to including the transaction result data. If you do not require data to be sent to the ServerURL, please leave this field empty.
DL | string(16) | This value is used to specify the styling and functionality Bambora should display to your customer. Please see section Payment Page Functionality for full details on DL value. Dl values will be confirmed by Bambora upon account setup.
AccountNumber | string(16) Optional | This value dictates which account the transaction will be processed through. Refer to section Account Hierarchy. If this value is not populated, the transaction will be processed to the account tied to the username field.
CustRef | string(64) | A reference for the transaction sent by you for reporting purposes.
CustNumber | string(64) Optional | An additional reference for the transaction sent by you for reporting purposes.
Email | string(64) Optional | An additional reference for the transaction sent by you for reporting purposes. Please note Bambora can enable this field to send an email receipt to the email address entered in this field. Please contact Bambora if you require this service.
Reference1 | string(32) Optional | This field name can be changed to something more suitable to your company for example “AccountID”. Please advise if you wish to change it. An additional reference that can be sent by you for reporting purposes e.g. a customer identifier unique to your system. This will be available to view and download with the transaction details in our reporting tool, PRM.
Reference2 | string(64) Optional | This field name can be changed to something more suitable to your company for example “AccountID”. Please advise if you wish to change it. An additional reference that can be sent by you for reporting purposes e.g. a customer identifier unique to your system. This will be available to view and download with the transaction details in our reporting tool, PRM.
Reference3 | string(128) Optional | This field name can be changed to something more suitable to your company for example “AccountID”. Please advise if you wish to change it. An additional reference that can be sent by you for reporting purposes e.g. a customer identifier unique to your system. This will be available to view and download with the transaction details in our reporting tool, PRM.
Reference4 | string(1024) Optional | This field name can be changed to something more suitable to your company for example “AccountID”. Please advise if you wish to change it. An additional reference that can be sent by you for reporting purposes e.g. a customer identifier unique to your system. This will be available to view and download with the transaction details in our reporting tool, PRM.
Reference5 | string(1024) Optional | This field name can be changed to something more suitable to your company for example “AccountID”. Please advise if you wish to change it. An additional reference that can be sent by you for reporting purposes e.g. a customer identifier unique to your system. This will be available to view and download with the transaction details in our reporting tool, PRM.
UserDeclinedURL | string(512) Optional | Bambora offer the ability to have a cancel button on your payment page. By default this page will redirect to the UserURL. If you wish this button to redirect to a different page other than the UserURL, you can specify the UserDeclinedURL in this field. If your customer selects the cancel button on the payment page, the page will be redirected to the declined URL. Please note if you send a value in this field, all responses for declined transactions will be sent to this URL including cancelled transactions and transactions which have been declined by the bank. Please see section Cancel Button for further information.

**Session Initiation Response - Body Schema**

Parameter |         | Description
--------- | ------- | -----------
SessionStored | string(64) | Value that can be either True or False
SessionStoredError | string(256) | Textual description of the error. This field will only be populated if the SessionStored value is False.
SST | string(64) | Secure Session Token.  This field will only be populated if the SessionStored value is True.

**Payment Page Request- Body Schema**

User Browser POST to Bambora Server

Parameter |         | Description
--------- | ------- | -----------
SessionStored | string(64) | Value that can be either True or False
SST | string(64) | Secure Session Token.  This field will only be populated if the SessionStored value is True.

**1st Payment Page Response - Body Schema**

The following table lists the response values that Bambora will POST to your server.

Parameter |         | Description
--------- | ------- | -----------
Result | string(1) | 0 = Declined 1 = Approve 2 = In progress 3 = Session Expired
Receipt | string(8) | The Bambora receipt number generated for this transaction
DeclinedCode | string(5) | Declined code interprets the error message
DeclinedMessage | string(256) | Reason message for declined
SST | string(64) | The Secure Session Token.
SessionKey | string(64)	| The session key submitted by you only to Bambora in the session initiation request.
SessionId | string(64) | Merchant unique session identifier
MaskedCard | string(16)	| The masked credit card number. This will show first 6 and last 4 digits of card number. E.g. 123456*****4321
ExpiryDate | string(5)	| The credit card expiry date. Format: MM/YY
CardHolderName | string(64)	| The credit card expiry date. Format: MM/YY
CardType | string(16) |	E.g. MasterCard, Visa, American Express, Diners
CardSubType | string(64)	| A value can be passed back giving further details on the card. This field is only returned if you have the CardSubType functionality enabled. Please see section Card SubType Recognition for further information.
TxDateTime | string(19)	| The transaction date/time. Format: YYYY-MM-DD HH:MM:SS E.g. 2010-01-20 18:32:30
CustNumber | string(64)	| An additional reference for the transaction sent by you for reporting purposes.
CustRef | string(64) | Merchant Reference for the transaction
Amount | string(10)	| Transaction amount in cent value e.g. $55.00 = 5500. This is the originally submitted amount and does not include any surcharge amount that may have been applied by Bambora.
Surcharge | string(10) | Surcharge amount applied to the transaction in cent value. This is only populated if surcharging is enabled on your account. Please see section Surcharging for further information.
Totalamount | string(10) |	Transaction amount plus surcharge amount applied to the transaction in cent value. This is only populated if surcharging is enabled on your account. Please see section Surcharging for further information.
SettlementDate | string(64) |	The settlement date of the transaction returned in the following format YYYY-MM-DD.
Reference1 | string(32)	| Additional optional reference submitted by you in the transaction request.
Reference2 | string(64)	| Additional optional reference submitted by you in the transaction request.
Reference3 | string(128)	| Additional optional reference submitted by you in the transaction request.
Reference4 | string(256)	| Additional optional reference submitted by you in the transaction request.
Reference5 | string(1024)	| Additional optional reference submitted by you in the transaction request.
Acctitle | string(60)	| Bank account holder name.
AccRouting | string(6)	| Bank account BSB. For NZ direct debit processing, this will include Bank and Branch Codes
Accno | string(16) | Bank account number. For NZ direct debit processing, this will include NZ Account number and Suffix

**2nd Payment Page Response - Body Schema**

The following table lists the values that Bambora will POST to your server when redirecting to your UserURL.

Parameter |         | Description
--------- | ------- | -----------
SessionStored | string(64) | Value that can be either True or False
SST | string(64) | Secure Session Token.  This field will only be populated if the SessionStored value is True.

#Standalone

Checkout Standalone is a low touch integration, providing an secure hosted payment page through a separate URL. Transactions are processed in real-time and the response displayed back to the customer. There is not redirect back to your business but the transaction result can be viewed through your Bambora Backoffice reporting facility.  

##Standalone v1

If the **Amount** has already been displayed on the page, you can use our Standalone v1 to only capture your customers' card details.

Sample URL

[https://demo.bambora.co.nz/access/index.aspx?a=85569861&dl=Checkout_v1_hpp_purchase&accountnumber=Exa-5149&amount=1000&custref=&custref=devportal](https://demo.bambora.co.nz/access/index.aspx?a=85569861&dl=Checkout_v1_hpp_purchase&accountnumber=Exa-5149&amount=1000&custref=&custref=devportal)

```shell
cURL "https://demo.bambora.co.nz/access/index.aspx"
-d 'a=85569861'
-d 'accountnumber=[AccountNumber]'
-d 'amount=[AmountValue]'
-d 'dl=Checkout_v1_hpp_purchase'
```

##Standalone v2

If you require your customers to enter the **Amount** and **Reference** on the page they can use our standalone checkout v2 page.

Sample URL

[https://demo.bambora.co.nz/access/index.aspx?a=85569861&dl=Checkout_v2_hpp_purchase&accountnumber=Exa-5149&amount=1000](https://demo.bambora.co.nz/access/index.aspx?a=85569861&dl=Checkout_v2_hpp_purchase&accountnumber=Exa-5149&amount=1000)

```shell
cURL "https://demo.bambora.co.nz/access/index.aspx"
-d 'a=85569861'
-d 'accountnumber=[AccountNumber]'
-d 'dl=Checkout_v2_hpp_purchase'
```


#Test payments using checkout

To make a payment using the checkout interface following details need to be provide in the test payment:

* Test Card Number
* Any three-digit CVC code
* Any expiration date in the future
* Reference (Mandatory if displayed on checkout page)
* Amount (Mandatory if displayed on checkout page)
